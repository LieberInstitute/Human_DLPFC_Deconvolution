**** Job starts ****
Fri Jan 26 01:27:27 PM EST 2024
**** JHPCE info ****
User: lhuuki
Job id: 1749621
Job name: 03_get_est_prop
Node name: compute-100
Task id: 
Loading conda_R/4.3.x

Currently Loaded Modules:
  1) JHPCE_ROCKY9_DEFAULT_ENV   3) ruby/3.2.2     5) conda/3-23.3.1
  2) JHPCE_tools/3.0            4) rmate/1.5.10   6) conda_R/4.3.x

 

── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
Loading required package: snowfall
Loading required package: snow
Loading required package: NMF
Loading required package: registry
Loading required package: rngtools
Loading required package: cluster
NMF - BioConductor layer [OK] | Shared memory capabilities [OK] | Cores 2/2
Warning messages:
1: replacing previous import ‘gplots::lowess’ by ‘stats::lowess’ when loading ‘BayesPrism’ 
2: replacing previous import ‘BiocParallel::register’ by ‘NMF::register’ when loading ‘BayesPrism’ 
here() starts at /dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution
# A tibble: 12 × 3
   method   cell_type     n
   <chr>    <chr>     <int>
 1 RNAscope Astro        12
 2 RNAscope Endo         12
 3 RNAscope Excit        13
 4 RNAscope Inhib        12
 5 RNAscope Micro        13
 6 RNAscope Oligo        13
 7 sn       Astro        19
 8 sn       Endo         19
 9 sn       Excit        15
10 sn       Inhib        19
11 sn       Micro        15
12 sn       Oligo        14
# A tibble: 2 × 2
  method       n
  <chr>    <int>
1 RNAscope    75
2 sn         101
[1] "est_prop_BayesPrisim_marker.Rdata" "est_prop_BayesPrisim.Rdata"       
[3] "est_prop_bisque.Rdata"             "est_prop_dwls_marker.Rdata"       
[5] "est_prop_dwls.Rdata"               "est_prop_hspe_markers.Rdata"      
[7] "est_prop_hspe.Rdata"               "est_prop_music.Rdata"             
Loading objects:
  est_prop_dwls
  Signature
                                   Inhib     Oligo        OPC     Excit
2107UNHS-0291_Br2720_Mid_Bulk 0.06304903 0.6902173 0.05148521 0.1042930
2107UNHS-0291_Br2720_Mid_Cyto 0.05903339 0.6097257 0.04210052 0.1636064
2107UNHS-0291_Br2720_Mid_Nuc  0.07202086 0.4414383 0.07316631 0.1384433
2107UNHS-0291_Br6432_Ant_Bulk 0.07362283 0.5826248 0.06841740 0.1245287
2107UNHS-0291_Br6432_Ant_Cyto 0.05595136 0.3026081 0.06799063 0.1854963
2107UNHS-0291_Br6432_Ant_Nuc  0.05778567 0.3392807 0.08586732 0.1204944
                                     Astro  EndoMural       Micro
2107UNHS-0291_Br2720_Mid_Bulk 4.980152e-07 0.08723415 0.003720786
2107UNHS-0291_Br2720_Mid_Cyto 3.638649e-07 0.11740074 0.008132868
2107UNHS-0291_Br2720_Mid_Nuc  6.996201e-02 0.20186461 0.003104644
2107UNHS-0291_Br6432_Ant_Bulk 2.092268e-02 0.11442955 0.015454063
2107UNHS-0291_Br6432_Ant_Cyto 1.752194e-01 0.19243245 0.020301797
2107UNHS-0291_Br6432_Ant_Nuc  1.935261e-01 0.19796584 0.005080060
Loading objects:
  est_prop_bisque
Loading objects:
  est_prop_music
[1] "Est.prop.weighted" "Est.prop.allgene"  "Weight.gene"      
[4] "r.squared.full"    "Var.prop"         
                                  Inhib     Oligo         OPC      Excit
2107UNHS-0291_Br2720_Mid_Bulk 0.1970804 0.6206662 0.004383865 0.07381391
2107UNHS-0291_Br2720_Mid_Cyto 0.1535989 0.5438689 0.029282096 0.20769965
2107UNHS-0291_Br2720_Mid_Nuc  0.2292689 0.3728979 0.045010200 0.18105744
2107UNHS-0291_Br6432_Ant_Bulk 0.2139221 0.4205721 0.026730094 0.15115657
2107UNHS-0291_Br6432_Ant_Cyto 0.2545020 0.3900680 0.043289869 0.19200530
2107UNHS-0291_Br6432_Ant_Nuc  0.2500557 0.2795502 0.058876415 0.23637844
                                   Astro  EndoMural       Micro
2107UNHS-0291_Br2720_Mid_Bulk 0.00000000 0.09524560 0.008810009
2107UNHS-0291_Br2720_Mid_Cyto 0.00000000 0.05112196 0.014428557
2107UNHS-0291_Br2720_Mid_Nuc  0.00000000 0.15678381 0.014981740
2107UNHS-0291_Br6432_Ant_Bulk 0.03395061 0.13529982 0.018368680
2107UNHS-0291_Br6432_Ant_Cyto 0.01313990 0.05987568 0.047119206
2107UNHS-0291_Br6432_Ant_Nuc  0.01965477 0.14336686 0.012117598
Loading objects:
  est_prop_hspe
Loading objects:
  est_prop_hspe
[1] "estimates" "markers"   "n_markers" "weights"   "diag"     
# A tibble: 7 × 3
  method cell_type     n
  <chr>  <chr>     <int>
1 hspe   Astro       220
2 hspe   EndoMural   220
3 hspe   Excit       220
4 hspe   Inhib       220
5 hspe   Micro       220
6 hspe   OPC         220
7 hspe   Oligo       220
Loading objects:
  est_prop_BayesPrisim_marker
  diff.exp.stat
Input prism info: 
Cell states in each cell type: 
$Inhib
[1] "Inhib"

$Oligo
[1] "Oligo"

$OPC
[1] "OPC"

$Excit
[1] "Excit"

$Astro
[1] "Astro"

$EndoMural
[1] "EndoMural"

$Micro
[1] "Micro"


Identifier of the malignant cell type:  NA 
Number of cell states:  7 
Number of cell types:  7 
Number of mixtures:  110 
Number of genes:  127 

Initial cell type fractions: 
        Inhib Oligo   OPC Excit Astro EndoMural Micro
Min.    0.000 0.072 0.000 0.000 0.000     0.000 0.000
1st Qu. 0.040 0.180 0.003 0.309 0.004     0.095 0.009
Median  0.078 0.278 0.019 0.388 0.060     0.123 0.016
Mean    0.074 0.290 0.019 0.401 0.077     0.122 0.017
3rd Qu. 0.107 0.349 0.029 0.511 0.124     0.148 0.025
Max.    0.142 0.997 0.072 0.740 0.239     0.251 0.043
Updated cell type fractions: 
        Inhib Oligo   OPC Excit Astro EndoMural Micro
Min.    0.000 0.070 0.000 0.000 0.000     0.000 0.000
1st Qu. 0.037 0.175 0.001 0.294 0.005     0.096 0.008
Median  0.078 0.273 0.019 0.378 0.068     0.123 0.017
Mean    0.075 0.285 0.019 0.397 0.084     0.123 0.018
3rd Qu. 0.112 0.344 0.030 0.514 0.134     0.148 0.025
Max.    0.148 0.998 0.075 0.749 0.253     0.249 0.044
[1] "prism"                       "posterior.initial.cellState"
[3] "posterior.initial.cellType"  "reference.update"           
[5] "posterior.theta_f"           "control_param"              
Joining with `by = join_by(cell_type, Sample)`
Joining with `by = join_by(Dataset)`
# A tibble: 6 × 3
  method      marker       n
  <chr>       <chr>    <int>
1 BayesPrisim MR_top25   770
2 Bisque      MR_top25   770
3 DWLS        MR_top25   770
4 MuSiC       MR_top25   770
5 hspe        ALL        770
6 hspe        MR_top25   770
# A tibble: 2 × 2
  `!is.na(RNAscope_prop)`     n
  <lgl>                   <int>
1 FALSE                    2604
2 TRUE                     2016
[1] "Reproducibility information:"
[1] "2024-01-26 13:27:56 EST"
   user  system elapsed 
 15.493   1.074  23.014 
─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.3.2 Patched (2023-11-13 r85524)
 os       Rocky Linux 9.2 (Blue Onyx)
 system   x86_64, linux-gnu
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       US/Eastern
 date     2024-01-26
 pandoc   3.1.3 @ /jhpce/shared/community/core/conda_R/4.3.x/bin/pandoc

─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────
 package              * version   date (UTC) lib source
 abind                  1.4-5     2016-07-21 [2] CRAN (R 4.3.2)
 BayesPrism           * 2.1.1     2023-12-06 [1] Github (Danko-Lab/BayesPrism@f98bd4d)
 beachmat               2.18.0    2023-10-24 [2] Bioconductor
 bigmemory            * 4.6.1     2022-05-02 [2] CRAN (R 4.3.2)
 bigmemory.sri          0.1.6     2022-11-09 [2] CRAN (R 4.3.2)
 Biobase              * 2.62.0    2023-10-24 [2] Bioconductor
 BiocGenerics         * 0.48.1    2023-11-01 [2] Bioconductor
 BiocManager            1.30.22   2023-08-08 [2] CRAN (R 4.3.2)
 BiocNeighbors          1.20.0    2023-10-24 [2] Bioconductor
 BiocParallel           1.36.0    2023-10-24 [2] Bioconductor
 BiocSingular           1.18.0    2023-10-24 [2] Bioconductor
 bit                    4.0.5     2022-11-15 [2] CRAN (R 4.3.2)
 bit64                  4.0.5     2020-08-30 [2] CRAN (R 4.3.2)
 bitops                 1.0-7     2021-04-24 [2] CRAN (R 4.3.2)
 bluster                1.12.0    2023-10-24 [2] Bioconductor
 caTools                1.18.2    2021-03-28 [2] CRAN (R 4.3.2)
 cli                    3.6.2     2023-12-11 [1] CRAN (R 4.3.2)
 cluster              * 2.1.4     2022-08-22 [3] CRAN (R 4.3.2)
 codetools              0.2-19    2023-02-01 [3] CRAN (R 4.3.2)
 colorspace             2.1-0     2023-01-23 [2] CRAN (R 4.3.2)
 crayon                 1.5.2     2022-09-29 [2] CRAN (R 4.3.2)
 DelayedArray           0.28.0    2023-10-24 [2] Bioconductor
 DelayedMatrixStats     1.24.0    2023-10-24 [2] Bioconductor
 digest                 0.6.33    2023-07-07 [2] CRAN (R 4.3.2)
 doParallel             1.0.17    2022-02-07 [2] CRAN (R 4.3.2)
 dplyr                * 1.1.3     2023-09-03 [2] CRAN (R 4.3.2)
 dqrng                  0.3.2     2023-11-29 [1] CRAN (R 4.3.2)
 edgeR                  4.0.2     2023-11-19 [1] Bioconductor 3.18 (R 4.3.2)
 fansi                  1.0.6     2023-12-08 [1] CRAN (R 4.3.2)
 forcats              * 1.0.0     2023-01-29 [2] CRAN (R 4.3.2)
 foreach                1.5.2     2022-02-02 [2] CRAN (R 4.3.2)
 generics               0.1.3     2022-07-05 [2] CRAN (R 4.3.2)
 GenomeInfoDb           1.38.5    2023-12-28 [1] Bioconductor 3.18 (R 4.3.2)
 GenomeInfoDbData       1.2.11    2023-11-15 [2] Bioconductor
 GenomicRanges          1.54.1    2023-10-29 [2] Bioconductor
 ggplot2              * 3.4.4     2023-10-12 [2] CRAN (R 4.3.2)
 glue                   1.6.2     2022-02-24 [2] CRAN (R 4.3.2)
 gplots                 3.1.3     2022-04-25 [2] CRAN (R 4.3.2)
 gridBase               0.4-7     2014-02-24 [1] CRAN (R 4.3.2)
 gtable                 0.3.4     2023-08-21 [2] CRAN (R 4.3.2)
 gtools                 3.9.5     2023-11-20 [1] CRAN (R 4.3.2)
 here                 * 1.0.1     2020-12-13 [2] CRAN (R 4.3.2)
 hms                    1.1.3     2023-03-21 [2] CRAN (R 4.3.2)
 igraph                 1.5.1     2023-08-10 [2] CRAN (R 4.3.2)
 IRanges                2.36.0    2023-10-24 [2] Bioconductor
 irlba                  2.3.5.1   2022-10-03 [2] CRAN (R 4.3.2)
 iterators              1.0.14    2022-02-05 [2] CRAN (R 4.3.2)
 KernSmooth             2.23-22   2023-07-10 [3] CRAN (R 4.3.2)
 lattice                0.22-5    2023-10-24 [3] CRAN (R 4.3.2)
 lifecycle              1.0.4     2023-11-07 [2] CRAN (R 4.3.2)
 limma                  3.58.1    2023-10-31 [2] Bioconductor
 locfit                 1.5-9.8   2023-06-11 [2] CRAN (R 4.3.2)
 lubridate            * 1.9.3     2023-09-27 [2] CRAN (R 4.3.2)
 magrittr               2.0.3     2022-03-30 [2] CRAN (R 4.3.2)
 Matrix                 1.6-3     2023-11-14 [3] CRAN (R 4.3.2)
 MatrixGenerics         1.14.0    2023-10-24 [2] Bioconductor
 matrixStats            1.2.0     2023-12-11 [1] CRAN (R 4.3.2)
 metapod                1.10.0    2023-10-24 [2] Bioconductor
 munsell                0.5.0     2018-06-12 [2] CRAN (R 4.3.2)
 NMF                  * 0.26      2023-03-20 [1] CRAN (R 4.3.2)
 pillar                 1.9.0     2023-03-22 [2] CRAN (R 4.3.2)
 pkgconfig              2.0.3     2019-09-22 [2] CRAN (R 4.3.2)
 plyr                   1.8.9     2023-10-02 [2] CRAN (R 4.3.2)
 purrr                * 1.0.2     2023-08-10 [2] CRAN (R 4.3.2)
 R6                     2.5.1     2021-08-19 [2] CRAN (R 4.3.2)
 RColorBrewer           1.1-3     2022-04-03 [2] CRAN (R 4.3.2)
 Rcpp                   1.0.11    2023-07-06 [2] CRAN (R 4.3.2)
 RCurl                  1.98-1.13 2023-11-02 [2] CRAN (R 4.3.2)
 readr                * 2.1.4     2023-02-10 [2] CRAN (R 4.3.2)
 registry             * 0.5-1     2019-03-05 [2] CRAN (R 4.3.2)
 reshape2               1.4.4     2020-04-09 [2] CRAN (R 4.3.2)
 rlang                  1.1.2     2023-11-04 [2] CRAN (R 4.3.2)
 rngtools             * 1.5.2     2021-09-20 [2] CRAN (R 4.3.2)
 rprojroot              2.0.4     2023-11-05 [2] CRAN (R 4.3.2)
 rsvd                   1.0.5     2021-04-16 [2] CRAN (R 4.3.2)
 S4Arrays               1.2.0     2023-10-24 [2] Bioconductor
 S4Vectors              0.40.2    2023-11-23 [1] Bioconductor 3.18 (R 4.3.2)
 ScaledMatrix           1.10.0    2023-10-24 [2] Bioconductor
 scales                 1.3.0     2023-11-28 [1] CRAN (R 4.3.2)
 scran                  1.30.0    2023-10-24 [2] Bioconductor
 scuttle                1.12.0    2023-10-24 [2] Bioconductor
 sessioninfo          * 1.2.2     2021-12-06 [2] CRAN (R 4.3.2)
 SingleCellExperiment   1.24.0    2023-10-24 [2] Bioconductor
 snow                 * 0.4-4     2021-10-27 [2] CRAN (R 4.3.2)
 snowfall             * 1.84-6.3  2023-11-26 [1] CRAN (R 4.3.2)
 SparseArray            1.2.3     2023-12-25 [1] Bioconductor 3.18 (R 4.3.2)
 sparseMatrixStats      1.14.0    2023-10-24 [2] Bioconductor
 statmod                1.5.0     2023-01-06 [2] CRAN (R 4.3.2)
 stringi                1.8.2     2023-11-23 [1] CRAN (R 4.3.2)
 stringr              * 1.5.1     2023-11-14 [2] CRAN (R 4.3.2)
 SummarizedExperiment   1.32.0    2023-10-24 [2] Bioconductor
 synchronicity        * 1.3.5     2018-08-21 [2] CRAN (R 4.3.2)
 tibble               * 3.2.1     2023-03-20 [2] CRAN (R 4.3.2)
 tidyr                * 1.3.0     2023-01-24 [2] CRAN (R 4.3.2)
 tidyselect             1.2.0     2022-10-10 [2] CRAN (R 4.3.2)
 tidyverse            * 2.0.0     2023-02-22 [2] CRAN (R 4.3.2)
 timechange             0.2.0     2023-01-11 [2] CRAN (R 4.3.2)
 tzdb                   0.4.0     2023-05-12 [2] CRAN (R 4.3.2)
 utf8                   1.2.4     2023-10-22 [2] CRAN (R 4.3.2)
 uuid                   1.1-1     2023-08-17 [2] CRAN (R 4.3.2)
 vctrs                  0.6.5     2023-12-01 [1] CRAN (R 4.3.2)
 vroom                  1.6.4     2023-10-02 [2] CRAN (R 4.3.2)
 withr                  2.5.2     2023-10-30 [2] CRAN (R 4.3.2)
 XVector                0.42.0    2023-10-24 [2] Bioconductor
 zlibbioc               1.48.0    2023-10-24 [2] Bioconductor

 [1] /users/lhuuki/R/4.3.x
 [2] /jhpce/shared/community/core/conda_R/4.3.x/R/lib64/R/site-library
 [3] /jhpce/shared/community/core/conda_R/4.3.x/R/lib64/R/library

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
**** Job ends ****
Fri Jan 26 01:27:59 PM EST 2024
