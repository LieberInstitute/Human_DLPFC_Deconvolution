Adding LIBD modules
Loading git
Loading LIBD module for git-status-size/github
Loading LIBD module for git-lfs/2.8.0
Loading LIBD module for rmate/1.5.9
Loading LIBD module for ruby/2.6.4p104
Loading conda_R/4.2.x
**** Job starts ****
Thu Apr 13 15:38:11 EDT 2023
**** JHPCE info ****
User: lhuuki
Job id: 3118942
Job name: check_bulk_qc_metrics
Hostname: compute-096.cm.cluster
Task id: undefined
Unloading conda_R/4.2.x
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV  11) ruby/2.6.4p104
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV      12) rmate/1.5.9
  3) JHPCE_tools/1.0   8) git-status-size/github         13) conda/3-4.11.0
  4) sge/8.1.9         9) git/2.28.0                     14) conda_R/4.2.x
  5) gcc/4.4.7        10) git-lfs/2.8.0

 

Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: GenomicRanges
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which.max, which.min

Loading required package: S4Vectors

Attaching package: ‘S4Vectors’

The following objects are masked from ‘package:base’:

    expand.grid, I, unname

Loading required package: IRanges
Loading required package: GenomeInfoDb
Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.1     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ lubridate::%within%() masks IRanges::%within%()
✖ dplyr::collapse()     masks IRanges::collapse()
✖ dplyr::combine()      masks Biobase::combine(), BiocGenerics::combine()
✖ dplyr::count()        masks matrixStats::count()
✖ dplyr::desc()         masks IRanges::desc()
✖ tidyr::expand()       masks S4Vectors::expand()
✖ dplyr::filter()       masks stats::filter()
✖ dplyr::first()        masks S4Vectors::first()
✖ dplyr::lag()          masks stats::lag()
✖ ggplot2::Position()   masks BiocGenerics::Position(), base::Position()
✖ purrr::reduce()       masks GenomicRanges::reduce(), IRanges::reduce()
✖ dplyr::rename()       masks S4Vectors::rename()
✖ lubridate::second()   masks S4Vectors::second()
✖ lubridate::second<-() masks S4Vectors::second<-()
✖ dplyr::slice()        masks IRanges::slice()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
here() starts at /dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution
Loading required package: rafalib
Loading required package: SingleCellExperiment
Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
Loading objects:
  rse_gene
[1] 58037  5761

RiboZeroGold  RiboZeroHMR 
          47          405 
Joining with `by = join_by(RNum)`

       polyA RiboZeroGold  RiboZeroHMR 
         727         4630          404 

            Astellas_DG         BrainSeq_Phase1   BrainSeq_Phase2_DLPFC 
                    263                     727                     453 
  BrainSeq_Phase2_HIPPO BrainSeq_Phase3_Caudate     BrainSeq_Phase4and5 
                    447                     464                     490 
               Habenula            Nicotine_NAc          psychENCODE_BP 
                     69                     235                      17 
       psychENCODE_Mood         PTSD_BrainOmics                 VA_PTSD 
                   1091                     225                    1280 
 [1] "SAMPLE_ID"         "RNum"              "RIN"              
 [4] "Region"            "Dataset"           "BrNum"            
 [7] "Dx"                "Age"               "Sex"              
[10] "Race"              "numReads"          "numMapped"        
[13] "numUnmapped"       "mitoMapped"        "totalMapped"      
[16] "overallMapRate"    "concordMapRate"    "mitoRate"         
[19] "rRNA_rate"         "totalAssignedGene" "bamFile"          
[22] "rna_preSwap_BrNum" "library_type"     
`summarise()` has grouped output by 'library_type'. You can override using the
`.groups` argument.
Saving 7 x 7 in image
Warning messages:
1: ggrepel: 10 unlabeled data points (too many overlaps). Consider increasing max.overlaps 
2: ggrepel: 4 unlabeled data points (too many overlaps). Consider increasing max.overlaps 
`summarise()` has grouped output by 'library_type'. You can override using the
`.groups` argument.
Loading objects:
  rse_gene
        Dataset round library_type  n
1 2107UNHS-0291     1        polyA 12
2 2107UNHS-0293     1 RiboZeroGold 12
3    AN00000904     2        polyA 44
4    AN00000906     2 RiboZeroGold 45
 [1] "SAMPLE_ID"                          "Sample"                            
 [3] "BrNum"                              "pos"                               
 [5] "Position"                           "library_prep"                      
 [7] "library_type"                       "library_combo"                     
 [9] "batch"                              "round"                             
[11] "fastq1"                             "fastq2"                            
[13] "strandness"                         "basic_statistics"                  
[15] "per_base_sequence_quality"          "per_tile_sequence_quality"         
[17] "per_sequence_quality_scores"        "per_base_sequence_content"         
[19] "per_sequence_gc_content"            "per_base_n_content"                
[21] "sequence_length_distribution"       "sequence_duplication_levels"       
[23] "overrepresented_sequences"          "adapter_content"                   
[25] "kmer_content"                       "SeqLength_R1"                      
[27] "percentGC_R1"                       "phred15.19_R1"                     
[29] "phred65.69_R1"                      "phred115.119_R1"                   
[31] "phred150.151_R1"                    "phredGT30_R1"                      
[33] "phredGT35_R1"                       "Adapter65.69_R1"                   
[35] "Adapter100.104_R1"                  "Adapter140_R1"                     
[37] "SeqLength_R2"                       "percentGC_R2"                      
[39] "phred15.19_R2"                      "phred65.69_R2"                     
[41] "phred115.119_R2"                    "phred150.151_R2"                   
[43] "phredGT30_R2"                       "phredGT35_R2"                      
[45] "Adapter65.69_R2"                    "Adapter100.104_R2"                 
[47] "Adapter140_R2"                      "trimmed"                           
[49] "ERCCsumLogErr"                      "numReads"                          
[51] "numMapped"                          "numUnmapped"                       
[53] "overallMapRate"                     "concordMapRate"                    
[55] "bamFile"                            "totalMapped"                       
[57] "mitoMapped"                         "mitoRate"                          
[59] "totalAssignedGene"                  "gene_Assigned"                     
[61] "gene_Unassigned_Unmapped"           "gene_Unassigned_Read_Type"         
[63] "gene_Unassigned_Singleton"          "gene_Unassigned_MappingQuality"    
[65] "gene_Unassigned_Chimera"            "gene_Unassigned_FragmentLength"    
[67] "gene_Unassigned_Duplicate"          "gene_Unassigned_MultiMapping"      
[69] "gene_Unassigned_Secondary"          "gene_Unassigned_NonSplit"          
[71] "gene_Unassigned_NoFeatures"         "gene_Unassigned_Overlapping_Length"
[73] "gene_Unassigned_Ambiguity"          "rRNA_rate"                         
[75] "Dataset"                           
# A tibble: 28 × 3
# Groups:   Test [11]
   Test                      value         n
   <chr>                     <chr>     <int>
 1 adapter_content           PASS        113
 2 basic_statistics          PASS        113
 3 overrepresented_sequences FAIL/WARN     8
 4 overrepresented_sequences PASS         25
 5 overrepresented_sequences PASS/WARN    23
 6 overrepresented_sequences WARN         42
 7 overrepresented_sequences WARN/PASS    15
 8 per_base_n_content        PASS        113
 9 per_base_sequence_content FAIL          5
10 per_base_sequence_content FAIL/WARN    95
# ℹ 18 more rows
# A tibble: 10 × 4
# Groups:   Dataset, Test [10]
   Dataset       Test                        value     n
   <chr>         <chr>                       <chr> <int>
 1 2107UNHS-0291 per_sequence_gc_content     FAIL      1
 2 2107UNHS-0291 sequence_duplication_levels FAIL     12
 3 2107UNHS-0293 per_base_sequence_content   FAIL      1
 4 2107UNHS-0293 per_sequence_gc_content     FAIL     10
 5 2107UNHS-0293 sequence_duplication_levels FAIL      4
 6 AN00000904    per_sequence_gc_content     FAIL      4
 7 AN00000904    sequence_duplication_levels FAIL     44
 8 AN00000906    per_base_sequence_content   FAIL      4
 9 AN00000906    per_sequence_gc_content     FAIL     41
10 AN00000906    sequence_duplication_levels FAIL     18
[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_RiboZeroGold_all.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_polyA_all.png"

[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_RiboZeroGold_focus.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_polyA_focus.png"

# A tibble: 14 × 4
   qc_var            cutoff_type library_type        cutoff
   <chr>             <chr>       <chr>                <dbl>
 1 concordMapRate    lower       polyA               0.953 
 2 concordMapRate    lower       RiboZeroGold        0.908 
 3 mitoRate          higher      polyA               0.340 
 4 mitoRate          higher      RiboZeroGold        0.0247
 5 numMapped         lower       polyA        61280789.    
 6 numMapped         lower       RiboZeroGold 48838795.    
 7 numReads          lower       polyA        65036118.    
 8 numReads          lower       RiboZeroGold 51168785.    
 9 overallMapRate    lower       polyA               0.955 
10 overallMapRate    lower       RiboZeroGold        0.931 
11 totalAssignedGene lower       polyA               0.690 
12 totalAssignedGene lower       RiboZeroGold        0.182 
13 totalMapped       lower       polyA        45653338.    
14 totalMapped       lower       RiboZeroGold 50556432.    
$concordMapRate

FALSE  TRUE 
   98    15 

$mitoRate

FALSE  TRUE 
  108     5 

$numMapped

FALSE  TRUE 
  111     2 

$numReads

FALSE  TRUE 
  112     1 

$overallMapRate

FALSE  TRUE 
   98    15 

$totalAssignedGene

FALSE  TRUE 
  102    11 

$totalMapped

FALSE  TRUE 
  111     2 

auto_outliers_drop
FALSE  TRUE 
  111     2 
# A tibble: 12 × 4
   SAMPLE_ID                    auto_drop auto_warn qc_class
   <chr>                        <lgl>     <lgl>     <chr>   
 1 2107UNHS-0293_Br2720_Mid_Nuc TRUE      FALSE     drop    
 2 AN00000904_Br2743_Ant_Cyto   TRUE      TRUE      drop    
 3 AN00000904_Br2743_Ant_Nuc    FALSE     TRUE      warn    
 4 AN00000904_Br6522_Mid_Cyto   FALSE     TRUE      warn    
 5 AN00000904_Br8325_Ant_Cyto   FALSE     TRUE      warn    
 6 AN00000904_Br8325_Ant_Nuc    FALSE     TRUE      warn    
 7 AN00000904_Br8492_Mid_Cyto   FALSE     TRUE      warn    
 8 AN00000904_Br8492_Mid_Nuc    FALSE     TRUE      warn    
 9 AN00000904_Br8492_Post_Cyto  FALSE     TRUE      warn    
10 AN00000906_Br2743_Ant_Cyto   FALSE     TRUE      warn    
11 AN00000906_Br8325_Mid_Nuc    FALSE     TRUE      warn    
12 AN00000906_Br8492_Mid_Nuc    FALSE     TRUE      warn    
Joining with `by = join_by(SAMPLE_ID)`
Saving 12 x 7 in image
Saving 12 x 7 in image
Saving 12 x 7 in image
Warning messages:
1: In geom_jitter(aes(shapre = qc_class), width = 0.2) :
  Ignoring unknown aesthetics: shapre
2: In geom_jitter(aes(shapre = qc_class), width = 0.2) :
  Ignoring unknown aesthetics: shapre
Saving 12 x 7 in image
Saving 12 x 7 in image
[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_boxplots_RiboZeroGold.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_boxplots_polyA.png"

Saving 7 x 7 in image
Error in `geom_jitter()`:
! Problem while computing aesthetics.
ℹ Error occurred in the 2nd layer.
Caused by error in `FUN()`:
! object 'auto_outlier' not found
Backtrace:
     ▆
  1. ├─ggplot2::ggsave(ercc_boxplot, filename = here(plot_dir, "ERCCsumLogErr_boxplot.png"))
  2. │ ├─grid::grid.draw(plot)
  3. │ └─ggplot2:::grid.draw.ggplot(plot)
  4. │   ├─base::print(x)
  5. │   └─ggplot2:::print.ggplot(x)
  6. │     ├─ggplot2::ggplot_build(x)
  7. │     └─ggplot2:::ggplot_build.ggplot(x)
  8. │       └─ggplot2:::by_layer(...)
  9. │         ├─rlang::try_fetch(...)
 10. │         │ ├─base::tryCatch(...)
 11. │         │ │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 12. │         │ │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 13. │         │ │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 14. │         │ └─base::withCallingHandlers(...)
 15. │         └─ggplot2 (local) f(l = layers[[i]], d = data[[i]])
 16. │           └─l$compute_aesthetics(d, plot)
 17. │             └─ggplot2 (local) compute_aesthetics(..., self = self)
 18. │               └─base::lapply(aesthetics, eval_tidy, data = data, env = env)
 19. │                 └─rlang (local) FUN(X[[i]], ...)
 20. └─base::.handleSimpleError(...)
 21.   └─rlang (local) h(simpleError(msg, call))
 22.     └─handlers[[1L]](cnd)
 23.       └─cli::cli_abort(...)
 24.         └─rlang::abort(...)
Execution halted
**** Job ends ****
Thu Apr 13 15:40:43 EDT 2023
Adding LIBD modules
Loading git
Loading LIBD module for git-status-size/github
Loading LIBD module for git-lfs/2.8.0
Loading LIBD module for rmate/1.5.9
Loading LIBD module for ruby/2.6.4p104
Loading conda_R/4.2.x
**** Job starts ****
Thu Apr 13 15:48:28 EDT 2023
**** JHPCE info ****
User: lhuuki
Job id: 3118978
Job name: check_bulk_qc_metrics
Hostname: compute-096.cm.cluster
Task id: undefined
Unloading conda_R/4.2.x
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV  11) ruby/2.6.4p104
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV      12) rmate/1.5.9
  3) JHPCE_tools/1.0   8) git-status-size/github         13) conda/3-4.11.0
  4) sge/8.1.9         9) git/2.28.0                     14) conda_R/4.2.x
  5) gcc/4.4.7        10) git-lfs/2.8.0

 

Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: GenomicRanges
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which.max, which.min

Loading required package: S4Vectors

Attaching package: ‘S4Vectors’

The following objects are masked from ‘package:base’:

    expand.grid, I, unname

Loading required package: IRanges
Loading required package: GenomeInfoDb
Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.1     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ lubridate::%within%() masks IRanges::%within%()
✖ dplyr::collapse()     masks IRanges::collapse()
✖ dplyr::combine()      masks Biobase::combine(), BiocGenerics::combine()
✖ dplyr::count()        masks matrixStats::count()
✖ dplyr::desc()         masks IRanges::desc()
✖ tidyr::expand()       masks S4Vectors::expand()
✖ dplyr::filter()       masks stats::filter()
✖ dplyr::first()        masks S4Vectors::first()
✖ dplyr::lag()          masks stats::lag()
✖ ggplot2::Position()   masks BiocGenerics::Position(), base::Position()
✖ purrr::reduce()       masks GenomicRanges::reduce(), IRanges::reduce()
✖ dplyr::rename()       masks S4Vectors::rename()
✖ lubridate::second()   masks S4Vectors::second()
✖ lubridate::second<-() masks S4Vectors::second<-()
✖ dplyr::slice()        masks IRanges::slice()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
here() starts at /dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution
Loading required package: rafalib
Loading required package: SingleCellExperiment
Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
Loading objects:
  rse_gene
[1] 58037  5761

RiboZeroGold  RiboZeroHMR 
          47          405 
Joining with `by = join_by(RNum)`

       polyA RiboZeroGold  RiboZeroHMR 
         727         4630          404 

            Astellas_DG         BrainSeq_Phase1   BrainSeq_Phase2_DLPFC 
                    263                     727                     453 
  BrainSeq_Phase2_HIPPO BrainSeq_Phase3_Caudate     BrainSeq_Phase4and5 
                    447                     464                     490 
               Habenula            Nicotine_NAc          psychENCODE_BP 
                     69                     235                      17 
       psychENCODE_Mood         PTSD_BrainOmics                 VA_PTSD 
                   1091                     225                    1280 
 [1] "SAMPLE_ID"         "RNum"              "RIN"              
 [4] "Region"            "Dataset"           "BrNum"            
 [7] "Dx"                "Age"               "Sex"              
[10] "Race"              "numReads"          "numMapped"        
[13] "numUnmapped"       "mitoMapped"        "totalMapped"      
[16] "overallMapRate"    "concordMapRate"    "mitoRate"         
[19] "rRNA_rate"         "totalAssignedGene" "bamFile"          
[22] "rna_preSwap_BrNum" "library_type"     
`summarise()` has grouped output by 'library_type'. You can override using the
`.groups` argument.
Saving 7 x 7 in image
Warning messages:
1: ggrepel: 10 unlabeled data points (too many overlaps). Consider increasing max.overlaps 
2: ggrepel: 4 unlabeled data points (too many overlaps). Consider increasing max.overlaps 
`summarise()` has grouped output by 'library_type'. You can override using the
`.groups` argument.
Loading objects:
  rse_gene
        Dataset round library_type  n
1 2107UNHS-0291     1        polyA 12
2 2107UNHS-0293     1 RiboZeroGold 12
3    AN00000904     2        polyA 44
4    AN00000906     2 RiboZeroGold 45
 [1] "SAMPLE_ID"                          "Sample"                            
 [3] "BrNum"                              "pos"                               
 [5] "Position"                           "library_prep"                      
 [7] "library_type"                       "library_combo"                     
 [9] "batch"                              "round"                             
[11] "fastq1"                             "fastq2"                            
[13] "strandness"                         "basic_statistics"                  
[15] "per_base_sequence_quality"          "per_tile_sequence_quality"         
[17] "per_sequence_quality_scores"        "per_base_sequence_content"         
[19] "per_sequence_gc_content"            "per_base_n_content"                
[21] "sequence_length_distribution"       "sequence_duplication_levels"       
[23] "overrepresented_sequences"          "adapter_content"                   
[25] "kmer_content"                       "SeqLength_R1"                      
[27] "percentGC_R1"                       "phred15.19_R1"                     
[29] "phred65.69_R1"                      "phred115.119_R1"                   
[31] "phred150.151_R1"                    "phredGT30_R1"                      
[33] "phredGT35_R1"                       "Adapter65.69_R1"                   
[35] "Adapter100.104_R1"                  "Adapter140_R1"                     
[37] "SeqLength_R2"                       "percentGC_R2"                      
[39] "phred15.19_R2"                      "phred65.69_R2"                     
[41] "phred115.119_R2"                    "phred150.151_R2"                   
[43] "phredGT30_R2"                       "phredGT35_R2"                      
[45] "Adapter65.69_R2"                    "Adapter100.104_R2"                 
[47] "Adapter140_R2"                      "trimmed"                           
[49] "ERCCsumLogErr"                      "numReads"                          
[51] "numMapped"                          "numUnmapped"                       
[53] "overallMapRate"                     "concordMapRate"                    
[55] "bamFile"                            "totalMapped"                       
[57] "mitoMapped"                         "mitoRate"                          
[59] "totalAssignedGene"                  "gene_Assigned"                     
[61] "gene_Unassigned_Unmapped"           "gene_Unassigned_Read_Type"         
[63] "gene_Unassigned_Singleton"          "gene_Unassigned_MappingQuality"    
[65] "gene_Unassigned_Chimera"            "gene_Unassigned_FragmentLength"    
[67] "gene_Unassigned_Duplicate"          "gene_Unassigned_MultiMapping"      
[69] "gene_Unassigned_Secondary"          "gene_Unassigned_NonSplit"          
[71] "gene_Unassigned_NoFeatures"         "gene_Unassigned_Overlapping_Length"
[73] "gene_Unassigned_Ambiguity"          "rRNA_rate"                         
[75] "Dataset"                           
# A tibble: 28 × 3
# Groups:   Test [11]
   Test                      value         n
   <chr>                     <chr>     <int>
 1 adapter_content           PASS        113
 2 basic_statistics          PASS        113
 3 overrepresented_sequences FAIL/WARN     8
 4 overrepresented_sequences PASS         25
 5 overrepresented_sequences PASS/WARN    23
 6 overrepresented_sequences WARN         42
 7 overrepresented_sequences WARN/PASS    15
 8 per_base_n_content        PASS        113
 9 per_base_sequence_content FAIL          5
10 per_base_sequence_content FAIL/WARN    95
# ℹ 18 more rows
# A tibble: 10 × 4
# Groups:   Dataset, Test [10]
   Dataset       Test                        value     n
   <chr>         <chr>                       <chr> <int>
 1 2107UNHS-0291 per_sequence_gc_content     FAIL      1
 2 2107UNHS-0291 sequence_duplication_levels FAIL     12
 3 2107UNHS-0293 per_base_sequence_content   FAIL      1
 4 2107UNHS-0293 per_sequence_gc_content     FAIL     10
 5 2107UNHS-0293 sequence_duplication_levels FAIL      4
 6 AN00000904    per_sequence_gc_content     FAIL      4
 7 AN00000904    sequence_duplication_levels FAIL     44
 8 AN00000906    per_base_sequence_content   FAIL      4
 9 AN00000906    per_sequence_gc_content     FAIL     41
10 AN00000906    sequence_duplication_levels FAIL     18
[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_RiboZeroGold_all.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_polyA_all.png"

[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_RiboZeroGold_focus.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_polyA_focus.png"

# A tibble: 14 × 4
   qc_var            cutoff_type library_type        cutoff
   <chr>             <chr>       <chr>                <dbl>
 1 concordMapRate    lower       polyA               0.953 
 2 concordMapRate    lower       RiboZeroGold        0.908 
 3 mitoRate          higher      polyA               0.340 
 4 mitoRate          higher      RiboZeroGold        0.0247
 5 numMapped         lower       polyA        61280789.    
 6 numMapped         lower       RiboZeroGold 48838795.    
 7 numReads          lower       polyA        65036118.    
 8 numReads          lower       RiboZeroGold 51168785.    
 9 overallMapRate    lower       polyA               0.955 
10 overallMapRate    lower       RiboZeroGold        0.931 
11 totalAssignedGene lower       polyA               0.690 
12 totalAssignedGene lower       RiboZeroGold        0.182 
13 totalMapped       lower       polyA        45653338.    
14 totalMapped       lower       RiboZeroGold 50556432.    
$concordMapRate

FALSE  TRUE 
   98    15 

$mitoRate

FALSE  TRUE 
  108     5 

$numMapped

FALSE  TRUE 
  111     2 

$numReads

FALSE  TRUE 
  112     1 

$overallMapRate

FALSE  TRUE 
   98    15 

$totalAssignedGene

FALSE  TRUE 
  102    11 

$totalMapped

FALSE  TRUE 
  111     2 

auto_outliers_drop
FALSE  TRUE 
  111     2 
# A tibble: 12 × 4
   SAMPLE_ID                    auto_drop auto_warn qc_class
   <chr>                        <lgl>     <lgl>     <chr>   
 1 2107UNHS-0293_Br2720_Mid_Nuc TRUE      FALSE     drop    
 2 AN00000904_Br2743_Ant_Cyto   TRUE      TRUE      drop    
 3 AN00000904_Br2743_Ant_Nuc    FALSE     TRUE      warn    
 4 AN00000904_Br6522_Mid_Cyto   FALSE     TRUE      warn    
 5 AN00000904_Br8325_Ant_Cyto   FALSE     TRUE      warn    
 6 AN00000904_Br8325_Ant_Nuc    FALSE     TRUE      warn    
 7 AN00000904_Br8492_Mid_Cyto   FALSE     TRUE      warn    
 8 AN00000904_Br8492_Mid_Nuc    FALSE     TRUE      warn    
 9 AN00000904_Br8492_Post_Cyto  FALSE     TRUE      warn    
10 AN00000906_Br2743_Ant_Cyto   FALSE     TRUE      warn    
11 AN00000906_Br8325_Mid_Nuc    FALSE     TRUE      warn    
12 AN00000906_Br8492_Mid_Nuc    FALSE     TRUE      warn    
Joining with `by = join_by(SAMPLE_ID)`
Saving 12 x 7 in image
Saving 12 x 7 in image
Saving 12 x 7 in image
Warning messages:
1: In geom_jitter(aes(shapre = qc_class), width = 0.2) :
  Ignoring unknown aesthetics: shapre
2: In geom_jitter(aes(shapre = qc_class), width = 0.2) :
  Ignoring unknown aesthetics: shapre
Saving 12 x 7 in image
Saving 12 x 7 in image
[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_boxplots_RiboZeroGold.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_boxplots_polyA.png"

Saving 7 x 7 in image
Error in `geom_jitter()`:
! Problem while computing aesthetics.
ℹ Error occurred in the 2nd layer.
Caused by error in `FUN()`:
! object 'qc_class' not found
Backtrace:
     ▆
  1. ├─ggplot2::ggsave(ercc_boxplot, filename = here(plot_dir, "ERCCsumLogErr_boxplot.png"))
  2. │ ├─grid::grid.draw(plot)
  3. │ └─ggplot2:::grid.draw.ggplot(plot)
  4. │   ├─base::print(x)
  5. │   └─ggplot2:::print.ggplot(x)
  6. │     ├─ggplot2::ggplot_build(x)
  7. │     └─ggplot2:::ggplot_build.ggplot(x)
  8. │       └─ggplot2:::by_layer(...)
  9. │         ├─rlang::try_fetch(...)
 10. │         │ ├─base::tryCatch(...)
 11. │         │ │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 12. │         │ │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 13. │         │ │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 14. │         │ └─base::withCallingHandlers(...)
 15. │         └─ggplot2 (local) f(l = layers[[i]], d = data[[i]])
 16. │           └─l$compute_aesthetics(d, plot)
 17. │             └─ggplot2 (local) compute_aesthetics(..., self = self)
 18. │               └─base::lapply(aesthetics, eval_tidy, data = data, env = env)
 19. │                 └─rlang (local) FUN(X[[i]], ...)
 20. └─base::.handleSimpleError(...)
 21.   └─rlang (local) h(simpleError(msg, call))
 22.     └─handlers[[1L]](cnd)
 23.       └─cli::cli_abort(...)
 24.         └─rlang::abort(...)
Execution halted
**** Job ends ****
Thu Apr 13 15:51:01 EDT 2023
Adding LIBD modules
Loading git
Loading LIBD module for git-status-size/github
Loading LIBD module for git-lfs/2.8.0
Loading LIBD module for rmate/1.5.9
Loading LIBD module for ruby/2.6.4p104
Loading conda_R/4.2.x
**** Job starts ****
Thu Apr 13 15:58:35 EDT 2023
**** JHPCE info ****
User: lhuuki
Job id: 3119006
Job name: check_bulk_qc_metrics
Hostname: compute-096.cm.cluster
Task id: undefined
Unloading conda_R/4.2.x
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV  11) ruby/2.6.4p104
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV      12) rmate/1.5.9
  3) JHPCE_tools/1.0   8) git-status-size/github         13) conda/3-4.11.0
  4) sge/8.1.9         9) git/2.28.0                     14) conda_R/4.2.x
  5) gcc/4.4.7        10) git-lfs/2.8.0

 

Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: GenomicRanges
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which.max, which.min

Loading required package: S4Vectors

Attaching package: ‘S4Vectors’

The following objects are masked from ‘package:base’:

    expand.grid, I, unname

Loading required package: IRanges
Loading required package: GenomeInfoDb
Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.1     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ lubridate::%within%() masks IRanges::%within%()
✖ dplyr::collapse()     masks IRanges::collapse()
✖ dplyr::combine()      masks Biobase::combine(), BiocGenerics::combine()
✖ dplyr::count()        masks matrixStats::count()
✖ dplyr::desc()         masks IRanges::desc()
✖ tidyr::expand()       masks S4Vectors::expand()
✖ dplyr::filter()       masks stats::filter()
✖ dplyr::first()        masks S4Vectors::first()
✖ dplyr::lag()          masks stats::lag()
✖ ggplot2::Position()   masks BiocGenerics::Position(), base::Position()
✖ purrr::reduce()       masks GenomicRanges::reduce(), IRanges::reduce()
✖ dplyr::rename()       masks S4Vectors::rename()
✖ lubridate::second()   masks S4Vectors::second()
✖ lubridate::second<-() masks S4Vectors::second<-()
✖ dplyr::slice()        masks IRanges::slice()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
here() starts at /dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution
Loading required package: rafalib
Loading required package: SingleCellExperiment
Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
Loading objects:
  rse_gene
[1] 58037  5761

RiboZeroGold  RiboZeroHMR 
          47          405 
Joining with `by = join_by(RNum)`

       polyA RiboZeroGold  RiboZeroHMR 
         727         4630          404 

            Astellas_DG         BrainSeq_Phase1   BrainSeq_Phase2_DLPFC 
                    263                     727                     453 
  BrainSeq_Phase2_HIPPO BrainSeq_Phase3_Caudate     BrainSeq_Phase4and5 
                    447                     464                     490 
               Habenula            Nicotine_NAc          psychENCODE_BP 
                     69                     235                      17 
       psychENCODE_Mood         PTSD_BrainOmics                 VA_PTSD 
                   1091                     225                    1280 
 [1] "SAMPLE_ID"         "RNum"              "RIN"              
 [4] "Region"            "Dataset"           "BrNum"            
 [7] "Dx"                "Age"               "Sex"              
[10] "Race"              "numReads"          "numMapped"        
[13] "numUnmapped"       "mitoMapped"        "totalMapped"      
[16] "overallMapRate"    "concordMapRate"    "mitoRate"         
[19] "rRNA_rate"         "totalAssignedGene" "bamFile"          
[22] "rna_preSwap_BrNum" "library_type"     
`summarise()` has grouped output by 'library_type'. You can override using the
`.groups` argument.
Saving 7 x 7 in image
Warning messages:
1: ggrepel: 10 unlabeled data points (too many overlaps). Consider increasing max.overlaps 
2: ggrepel: 4 unlabeled data points (too many overlaps). Consider increasing max.overlaps 
`summarise()` has grouped output by 'library_type'. You can override using the
`.groups` argument.
Loading objects:
  rse_gene
        Dataset round library_type  n
1 2107UNHS-0291     1        polyA 12
2 2107UNHS-0293     1 RiboZeroGold 12
3    AN00000904     2        polyA 44
4    AN00000906     2 RiboZeroGold 45
 [1] "SAMPLE_ID"                          "Sample"                            
 [3] "BrNum"                              "pos"                               
 [5] "Position"                           "library_prep"                      
 [7] "library_type"                       "library_combo"                     
 [9] "batch"                              "round"                             
[11] "fastq1"                             "fastq2"                            
[13] "strandness"                         "basic_statistics"                  
[15] "per_base_sequence_quality"          "per_tile_sequence_quality"         
[17] "per_sequence_quality_scores"        "per_base_sequence_content"         
[19] "per_sequence_gc_content"            "per_base_n_content"                
[21] "sequence_length_distribution"       "sequence_duplication_levels"       
[23] "overrepresented_sequences"          "adapter_content"                   
[25] "kmer_content"                       "SeqLength_R1"                      
[27] "percentGC_R1"                       "phred15.19_R1"                     
[29] "phred65.69_R1"                      "phred115.119_R1"                   
[31] "phred150.151_R1"                    "phredGT30_R1"                      
[33] "phredGT35_R1"                       "Adapter65.69_R1"                   
[35] "Adapter100.104_R1"                  "Adapter140_R1"                     
[37] "SeqLength_R2"                       "percentGC_R2"                      
[39] "phred15.19_R2"                      "phred65.69_R2"                     
[41] "phred115.119_R2"                    "phred150.151_R2"                   
[43] "phredGT30_R2"                       "phredGT35_R2"                      
[45] "Adapter65.69_R2"                    "Adapter100.104_R2"                 
[47] "Adapter140_R2"                      "trimmed"                           
[49] "ERCCsumLogErr"                      "numReads"                          
[51] "numMapped"                          "numUnmapped"                       
[53] "overallMapRate"                     "concordMapRate"                    
[55] "bamFile"                            "totalMapped"                       
[57] "mitoMapped"                         "mitoRate"                          
[59] "totalAssignedGene"                  "gene_Assigned"                     
[61] "gene_Unassigned_Unmapped"           "gene_Unassigned_Read_Type"         
[63] "gene_Unassigned_Singleton"          "gene_Unassigned_MappingQuality"    
[65] "gene_Unassigned_Chimera"            "gene_Unassigned_FragmentLength"    
[67] "gene_Unassigned_Duplicate"          "gene_Unassigned_MultiMapping"      
[69] "gene_Unassigned_Secondary"          "gene_Unassigned_NonSplit"          
[71] "gene_Unassigned_NoFeatures"         "gene_Unassigned_Overlapping_Length"
[73] "gene_Unassigned_Ambiguity"          "rRNA_rate"                         
[75] "Dataset"                           
# A tibble: 28 × 3
# Groups:   Test [11]
   Test                      value         n
   <chr>                     <chr>     <int>
 1 adapter_content           PASS        113
 2 basic_statistics          PASS        113
 3 overrepresented_sequences FAIL/WARN     8
 4 overrepresented_sequences PASS         25
 5 overrepresented_sequences PASS/WARN    23
 6 overrepresented_sequences WARN         42
 7 overrepresented_sequences WARN/PASS    15
 8 per_base_n_content        PASS        113
 9 per_base_sequence_content FAIL          5
10 per_base_sequence_content FAIL/WARN    95
# ℹ 18 more rows
# A tibble: 10 × 4
# Groups:   Dataset, Test [10]
   Dataset       Test                        value     n
   <chr>         <chr>                       <chr> <int>
 1 2107UNHS-0291 per_sequence_gc_content     FAIL      1
 2 2107UNHS-0291 sequence_duplication_levels FAIL     12
 3 2107UNHS-0293 per_base_sequence_content   FAIL      1
 4 2107UNHS-0293 per_sequence_gc_content     FAIL     10
 5 2107UNHS-0293 sequence_duplication_levels FAIL      4
 6 AN00000904    per_sequence_gc_content     FAIL      4
 7 AN00000904    sequence_duplication_levels FAIL     44
 8 AN00000906    per_base_sequence_content   FAIL      4
 9 AN00000906    per_sequence_gc_content     FAIL     41
10 AN00000906    sequence_duplication_levels FAIL     18
[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_RiboZeroGold_all.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_polyA_all.png"

[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_RiboZeroGold_focus.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_polyA_focus.png"

# A tibble: 14 × 4
   qc_var            cutoff_type library_type        cutoff
   <chr>             <chr>       <chr>                <dbl>
 1 concordMapRate    lower       polyA               0.953 
 2 concordMapRate    lower       RiboZeroGold        0.908 
 3 mitoRate          higher      polyA               0.340 
 4 mitoRate          higher      RiboZeroGold        0.0247
 5 numMapped         lower       polyA        61280789.    
 6 numMapped         lower       RiboZeroGold 48838795.    
 7 numReads          lower       polyA        65036118.    
 8 numReads          lower       RiboZeroGold 51168785.    
 9 overallMapRate    lower       polyA               0.955 
10 overallMapRate    lower       RiboZeroGold        0.931 
11 totalAssignedGene lower       polyA               0.690 
12 totalAssignedGene lower       RiboZeroGold        0.182 
13 totalMapped       lower       polyA        45653338.    
14 totalMapped       lower       RiboZeroGold 50556432.    
$concordMapRate

FALSE  TRUE 
   98    15 

$mitoRate

FALSE  TRUE 
  108     5 

$numMapped

FALSE  TRUE 
  111     2 

$numReads

FALSE  TRUE 
  112     1 

$overallMapRate

FALSE  TRUE 
   98    15 

$totalAssignedGene

FALSE  TRUE 
  102    11 

$totalMapped

FALSE  TRUE 
  111     2 

auto_outliers_drop
FALSE  TRUE 
  111     2 
# A tibble: 12 × 4
   SAMPLE_ID                    auto_drop auto_warn qc_class
   <chr>                        <lgl>     <lgl>     <chr>   
 1 2107UNHS-0293_Br2720_Mid_Nuc TRUE      FALSE     drop    
 2 AN00000904_Br2743_Ant_Cyto   TRUE      TRUE      drop    
 3 AN00000904_Br2743_Ant_Nuc    FALSE     TRUE      warn    
 4 AN00000904_Br6522_Mid_Cyto   FALSE     TRUE      warn    
 5 AN00000904_Br8325_Ant_Cyto   FALSE     TRUE      warn    
 6 AN00000904_Br8325_Ant_Nuc    FALSE     TRUE      warn    
 7 AN00000904_Br8492_Mid_Cyto   FALSE     TRUE      warn    
 8 AN00000904_Br8492_Mid_Nuc    FALSE     TRUE      warn    
 9 AN00000904_Br8492_Post_Cyto  FALSE     TRUE      warn    
10 AN00000906_Br2743_Ant_Cyto   FALSE     TRUE      warn    
11 AN00000906_Br8325_Mid_Nuc    FALSE     TRUE      warn    
12 AN00000906_Br8492_Mid_Nuc    FALSE     TRUE      warn    
Joining with `by = join_by(SAMPLE_ID)`
Saving 12 x 7 in image
Saving 12 x 7 in image
Saving 12 x 7 in image
Warning messages:
1: In geom_jitter(aes(shapre = qc_class), width = 0.2) :
  Ignoring unknown aesthetics: shapre
2: In geom_jitter(aes(shapre = qc_class), width = 0.2) :
  Ignoring unknown aesthetics: shapre
Saving 12 x 7 in image
Saving 12 x 7 in image
[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_boxplots_RiboZeroGold.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_boxplots_polyA.png"

Joining with `by = join_by(SAMPLE_ID)`
Saving 7 x 7 in image
Saving 7 x 7 in image
Joining with `by = join_by(SAMPLE_ID, library_prep, qc_class)`
[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/ERCC_scatter_RiboZeroGold.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/ERCC_scatter_polyA.png"

[1] "Reproducibility information:"
[1] "2023-04-13 16:01:08 EDT"
   user  system elapsed 
146.912   3.770 152.104 
─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.2.3 Patched (2023-04-07 r84211)
 os       CentOS Linux 7 (Core)
 system   x86_64, linux-gnu
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       US/Eastern
 date     2023-04-13
 pandoc   2.19.2 @ /jhpce/shared/jhpce/core/conda/miniconda3-4.11.0/envs/svnR-4.2.x/bin/pandoc

─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────
 package              * version   date (UTC) lib source
 beachmat               2.14.2    2023-04-07 [2] Bioconductor
 Biobase              * 2.58.0    2022-11-01 [2] Bioconductor
 BiocGenerics         * 0.44.0    2022-11-01 [2] Bioconductor
 BiocParallel           1.32.6    2023-03-17 [2] Bioconductor
 bitops                 1.0-7     2021-04-24 [2] CRAN (R 4.2.1)
 cellranger             1.1.0     2016-07-27 [2] CRAN (R 4.2.1)
 cli                    3.6.1     2023-03-23 [2] CRAN (R 4.2.3)
 codetools              0.2-19    2023-02-01 [3] CRAN (R 4.2.3)
 colorspace             2.1-0     2023-01-23 [2] CRAN (R 4.2.2)
 DelayedArray           0.24.0    2022-11-01 [2] Bioconductor
 DelayedMatrixStats     1.20.0    2022-11-01 [2] Bioconductor
 dplyr                * 1.1.1     2023-03-22 [2] CRAN (R 4.2.3)
 fansi                  1.0.4     2023-01-22 [2] CRAN (R 4.2.2)
 farver                 2.1.1     2022-07-06 [2] CRAN (R 4.2.1)
 forcats              * 1.0.0     2023-01-29 [2] CRAN (R 4.2.2)
 fs                     1.6.1     2023-02-06 [2] CRAN (R 4.2.2)
 gargle                 1.3.0     2023-01-30 [2] CRAN (R 4.2.2)
 generics               0.1.3     2022-07-05 [2] CRAN (R 4.2.1)
 GenomeInfoDb         * 1.34.9    2023-02-02 [2] Bioconductor
 GenomeInfoDbData       1.2.9     2022-09-29 [2] Bioconductor
 GenomicRanges        * 1.50.2    2022-12-16 [2] Bioconductor
 GGally               * 2.1.2     2021-06-21 [2] CRAN (R 4.2.1)
 ggplot2              * 3.4.2     2023-04-03 [2] CRAN (R 4.2.3)
 ggrepel              * 0.9.3     2023-02-03 [2] CRAN (R 4.2.2)
 glue                   1.6.2     2022-02-24 [2] CRAN (R 4.2.1)
 googledrive            2.1.0     2023-03-22 [2] CRAN (R 4.2.3)
 gtable                 0.3.3     2023-03-21 [2] CRAN (R 4.2.3)
 here                 * 1.0.1     2020-12-13 [2] CRAN (R 4.2.1)
 hms                    1.1.3     2023-03-21 [2] CRAN (R 4.2.3)
 IRanges              * 2.32.0    2022-11-01 [2] Bioconductor
 jaffelab             * 0.99.32   2022-12-07 [1] Github (LieberInstitute/jaffelab@7b7afe3)
 labeling               0.4.2     2020-10-20 [2] CRAN (R 4.2.1)
 lattice                0.20-45   2021-09-22 [3] CRAN (R 4.2.3)
 lifecycle              1.0.3     2022-10-07 [2] CRAN (R 4.2.1)
 limma                  3.54.2    2023-02-28 [2] Bioconductor
 lubridate            * 1.9.2     2023-02-10 [2] CRAN (R 4.2.2)
 magrittr               2.0.3     2022-03-30 [2] CRAN (R 4.2.1)
 MASS                   7.3-58.2  2023-01-23 [3] CRAN (R 4.2.3)
 Matrix                 1.5-4     2023-04-04 [2] CRAN (R 4.2.3)
 MatrixGenerics       * 1.10.0    2022-11-01 [2] Bioconductor
 matrixStats          * 0.63.0    2022-11-18 [2] CRAN (R 4.2.2)
 munsell                0.5.0     2018-06-12 [2] CRAN (R 4.2.1)
 nlme                   3.1-162   2023-01-31 [2] CRAN (R 4.2.2)
 patchwork            * 1.1.2     2022-08-19 [2] CRAN (R 4.2.1)
 pillar                 1.9.0     2023-03-22 [2] CRAN (R 4.2.3)
 pkgconfig              2.0.3     2019-09-22 [2] CRAN (R 4.2.1)
 plyr                   1.8.8     2022-11-11 [2] CRAN (R 4.2.2)
 purrr                * 1.0.1     2023-01-10 [2] CRAN (R 4.2.2)
 R6                     2.5.1     2021-08-19 [2] CRAN (R 4.2.1)
 rafalib              * 1.0.0     2015-08-09 [1] CRAN (R 4.2.2)
 ragg                   1.2.5     2023-01-12 [2] CRAN (R 4.2.2)
 RColorBrewer           1.1-3     2022-04-03 [2] CRAN (R 4.2.1)
 Rcpp                   1.0.10    2023-01-22 [2] CRAN (R 4.2.2)
 RCurl                  1.98-1.12 2023-03-27 [2] CRAN (R 4.2.3)
 readr                * 2.1.4     2023-02-10 [2] CRAN (R 4.2.2)
 readxl               * 1.4.2     2023-02-09 [2] CRAN (R 4.2.2)
 reshape                0.8.9     2022-04-12 [2] CRAN (R 4.2.1)
 rlang                  1.1.0     2023-03-14 [2] CRAN (R 4.2.3)
 rprojroot              2.0.3     2022-04-02 [2] CRAN (R 4.2.1)
 S4Vectors            * 0.36.2    2023-02-26 [2] Bioconductor
 scales                 1.2.1     2022-08-20 [2] CRAN (R 4.2.1)
 scuttle              * 1.8.4     2023-01-19 [1] Bioconductor
 segmented              1.6-3     2023-03-26 [1] CRAN (R 4.2.3)
 sessioninfo          * 1.2.2     2021-12-06 [2] CRAN (R 4.2.1)
 SingleCellExperiment * 1.20.1    2023-03-17 [2] Bioconductor
 sparseMatrixStats      1.10.0    2022-11-01 [2] Bioconductor
 stringi                1.7.12    2023-01-11 [2] CRAN (R 4.2.2)
 stringr              * 1.5.0     2022-12-02 [2] CRAN (R 4.2.2)
 SummarizedExperiment * 1.28.0    2022-11-01 [2] Bioconductor
 systemfonts            1.0.4     2022-02-11 [2] CRAN (R 4.2.1)
 textshaping            0.3.6     2021-10-13 [2] CRAN (R 4.2.1)
 tibble               * 3.2.1     2023-03-20 [2] CRAN (R 4.2.3)
 tidyr                * 1.3.0     2023-01-24 [2] CRAN (R 4.2.2)
 tidyselect             1.2.0     2022-10-10 [2] CRAN (R 4.2.1)
 tidyverse            * 2.0.0     2023-02-22 [2] CRAN (R 4.2.2)
 timechange             0.2.0     2023-01-11 [2] CRAN (R 4.2.2)
 tzdb                   0.3.0     2022-03-28 [2] CRAN (R 4.2.1)
 utf8                   1.2.3     2023-01-31 [2] CRAN (R 4.2.2)
 vctrs                  0.6.1     2023-03-22 [2] CRAN (R 4.2.3)
 withr                  2.5.0     2022-03-03 [2] CRAN (R 4.2.1)
 XVector                0.38.0    2022-11-01 [2] Bioconductor
 zlibbioc               1.44.0    2022-11-01 [2] Bioconductor

 [1] /users/lhuuki/R/4.2.x
 [2] /jhpce/shared/jhpce/core/conda/miniconda3-4.11.0/envs/svnR-4.2.x/R/4.2.x/lib64/R/site-library
 [3] /jhpce/shared/jhpce/core/conda/miniconda3-4.11.0/envs/svnR-4.2.x/R/4.2.x/lib64/R/library

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
**** Job ends ****
Thu Apr 13 16:01:10 EDT 2023
Adding LIBD modules
Loading git
Loading LIBD module for git-status-size/github
Loading LIBD module for git-lfs/2.8.0
Loading LIBD module for rmate/1.5.9
Loading LIBD module for ruby/2.6.4p104
Loading conda_R/4.2.x
**** Job starts ****
Thu Apr 13 16:05:38 EDT 2023
**** JHPCE info ****
User: lhuuki
Job id: 3119009
Job name: check_bulk_qc_metrics
Hostname: compute-096.cm.cluster
Task id: undefined
Unloading conda_R/4.2.x
Loading conda_R/4.2.x

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV  11) ruby/2.6.4p104
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV      12) rmate/1.5.9
  3) JHPCE_tools/1.0   8) git-status-size/github         13) conda/3-4.11.0
  4) sge/8.1.9         9) git/2.28.0                     14) conda_R/4.2.x
  5) gcc/4.4.7        10) git-lfs/2.8.0

 

Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: GenomicRanges
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which.max, which.min

Loading required package: S4Vectors

Attaching package: ‘S4Vectors’

The following objects are masked from ‘package:base’:

    expand.grid, I, unname

Loading required package: IRanges
Loading required package: GenomeInfoDb
Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.1     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ lubridate::%within%() masks IRanges::%within%()
✖ dplyr::collapse()     masks IRanges::collapse()
✖ dplyr::combine()      masks Biobase::combine(), BiocGenerics::combine()
✖ dplyr::count()        masks matrixStats::count()
✖ dplyr::desc()         masks IRanges::desc()
✖ tidyr::expand()       masks S4Vectors::expand()
✖ dplyr::filter()       masks stats::filter()
✖ dplyr::first()        masks S4Vectors::first()
✖ dplyr::lag()          masks stats::lag()
✖ ggplot2::Position()   masks BiocGenerics::Position(), base::Position()
✖ purrr::reduce()       masks GenomicRanges::reduce(), IRanges::reduce()
✖ dplyr::rename()       masks S4Vectors::rename()
✖ lubridate::second()   masks S4Vectors::second()
✖ lubridate::second<-() masks S4Vectors::second<-()
✖ dplyr::slice()        masks IRanges::slice()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
here() starts at /dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution
Loading required package: rafalib
Loading required package: SingleCellExperiment
Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
Loading objects:
  rse_gene
[1] 58037  5761

RiboZeroGold  RiboZeroHMR 
          47          405 
Joining with `by = join_by(RNum)`

       polyA RiboZeroGold  RiboZeroHMR 
         727         4630          404 

            Astellas_DG         BrainSeq_Phase1   BrainSeq_Phase2_DLPFC 
                    263                     727                     453 
  BrainSeq_Phase2_HIPPO BrainSeq_Phase3_Caudate     BrainSeq_Phase4and5 
                    447                     464                     490 
               Habenula            Nicotine_NAc          psychENCODE_BP 
                     69                     235                      17 
       psychENCODE_Mood         PTSD_BrainOmics                 VA_PTSD 
                   1091                     225                    1280 
 [1] "SAMPLE_ID"         "RNum"              "RIN"              
 [4] "Region"            "Dataset"           "BrNum"            
 [7] "Dx"                "Age"               "Sex"              
[10] "Race"              "numReads"          "numMapped"        
[13] "numUnmapped"       "mitoMapped"        "totalMapped"      
[16] "overallMapRate"    "concordMapRate"    "mitoRate"         
[19] "rRNA_rate"         "totalAssignedGene" "bamFile"          
[22] "rna_preSwap_BrNum" "library_type"     
`summarise()` has grouped output by 'library_type'. You can override using the
`.groups` argument.
Saving 7 x 7 in image
Warning messages:
1: ggrepel: 10 unlabeled data points (too many overlaps). Consider increasing max.overlaps 
2: ggrepel: 4 unlabeled data points (too many overlaps). Consider increasing max.overlaps 
`summarise()` has grouped output by 'library_type'. You can override using the
`.groups` argument.
Loading objects:
  rse_gene
        Dataset round library_type  n
1 2107UNHS-0291     1        polyA 12
2 2107UNHS-0293     1 RiboZeroGold 12
3    AN00000904     2        polyA 44
4    AN00000906     2 RiboZeroGold 45
 [1] "SAMPLE_ID"                          "Sample"                            
 [3] "BrNum"                              "pos"                               
 [5] "Position"                           "library_prep"                      
 [7] "library_type"                       "library_combo"                     
 [9] "batch"                              "round"                             
[11] "fastq1"                             "fastq2"                            
[13] "strandness"                         "basic_statistics"                  
[15] "per_base_sequence_quality"          "per_tile_sequence_quality"         
[17] "per_sequence_quality_scores"        "per_base_sequence_content"         
[19] "per_sequence_gc_content"            "per_base_n_content"                
[21] "sequence_length_distribution"       "sequence_duplication_levels"       
[23] "overrepresented_sequences"          "adapter_content"                   
[25] "kmer_content"                       "SeqLength_R1"                      
[27] "percentGC_R1"                       "phred15.19_R1"                     
[29] "phred65.69_R1"                      "phred115.119_R1"                   
[31] "phred150.151_R1"                    "phredGT30_R1"                      
[33] "phredGT35_R1"                       "Adapter65.69_R1"                   
[35] "Adapter100.104_R1"                  "Adapter140_R1"                     
[37] "SeqLength_R2"                       "percentGC_R2"                      
[39] "phred15.19_R2"                      "phred65.69_R2"                     
[41] "phred115.119_R2"                    "phred150.151_R2"                   
[43] "phredGT30_R2"                       "phredGT35_R2"                      
[45] "Adapter65.69_R2"                    "Adapter100.104_R2"                 
[47] "Adapter140_R2"                      "trimmed"                           
[49] "ERCCsumLogErr"                      "numReads"                          
[51] "numMapped"                          "numUnmapped"                       
[53] "overallMapRate"                     "concordMapRate"                    
[55] "bamFile"                            "totalMapped"                       
[57] "mitoMapped"                         "mitoRate"                          
[59] "totalAssignedGene"                  "gene_Assigned"                     
[61] "gene_Unassigned_Unmapped"           "gene_Unassigned_Read_Type"         
[63] "gene_Unassigned_Singleton"          "gene_Unassigned_MappingQuality"    
[65] "gene_Unassigned_Chimera"            "gene_Unassigned_FragmentLength"    
[67] "gene_Unassigned_Duplicate"          "gene_Unassigned_MultiMapping"      
[69] "gene_Unassigned_Secondary"          "gene_Unassigned_NonSplit"          
[71] "gene_Unassigned_NoFeatures"         "gene_Unassigned_Overlapping_Length"
[73] "gene_Unassigned_Ambiguity"          "rRNA_rate"                         
[75] "Dataset"                           
# A tibble: 28 × 3
# Groups:   Test [11]
   Test                      value         n
   <chr>                     <chr>     <int>
 1 adapter_content           PASS        113
 2 basic_statistics          PASS        113
 3 overrepresented_sequences FAIL/WARN     8
 4 overrepresented_sequences PASS         25
 5 overrepresented_sequences PASS/WARN    23
 6 overrepresented_sequences WARN         42
 7 overrepresented_sequences WARN/PASS    15
 8 per_base_n_content        PASS        113
 9 per_base_sequence_content FAIL          5
10 per_base_sequence_content FAIL/WARN    95
# ℹ 18 more rows
# A tibble: 10 × 4
# Groups:   Dataset, Test [10]
   Dataset       Test                        value     n
   <chr>         <chr>                       <chr> <int>
 1 2107UNHS-0291 per_sequence_gc_content     FAIL      1
 2 2107UNHS-0291 sequence_duplication_levels FAIL     12
 3 2107UNHS-0293 per_base_sequence_content   FAIL      1
 4 2107UNHS-0293 per_sequence_gc_content     FAIL     10
 5 2107UNHS-0293 sequence_duplication_levels FAIL      4
 6 AN00000904    per_sequence_gc_content     FAIL      4
 7 AN00000904    sequence_duplication_levels FAIL     44
 8 AN00000906    per_base_sequence_content   FAIL      4
 9 AN00000906    per_sequence_gc_content     FAIL     41
10 AN00000906    sequence_duplication_levels FAIL     18
[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_RiboZeroGold_all.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_polyA_all.png"

[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_RiboZeroGold_focus.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_ggpairs_polyA_focus.png"

# A tibble: 14 × 4
   qc_var            cutoff_type library_type        cutoff
   <chr>             <chr>       <chr>                <dbl>
 1 concordMapRate    lower       polyA               0.953 
 2 concordMapRate    lower       RiboZeroGold        0.908 
 3 mitoRate          higher      polyA               0.340 
 4 mitoRate          higher      RiboZeroGold        0.0247
 5 numMapped         lower       polyA        61280789.    
 6 numMapped         lower       RiboZeroGold 48838795.    
 7 numReads          lower       polyA        65036118.    
 8 numReads          lower       RiboZeroGold 51168785.    
 9 overallMapRate    lower       polyA               0.955 
10 overallMapRate    lower       RiboZeroGold        0.931 
11 totalAssignedGene lower       polyA               0.690 
12 totalAssignedGene lower       RiboZeroGold        0.182 
13 totalMapped       lower       polyA        45653338.    
14 totalMapped       lower       RiboZeroGold 50556432.    
$concordMapRate

FALSE  TRUE 
   98    15 

$mitoRate

FALSE  TRUE 
  108     5 

$numMapped

FALSE  TRUE 
  111     2 

$numReads

FALSE  TRUE 
  112     1 

$overallMapRate

FALSE  TRUE 
   98    15 

$totalAssignedGene

FALSE  TRUE 
  102    11 

$totalMapped

FALSE  TRUE 
  111     2 

auto_outliers_drop
FALSE  TRUE 
  111     2 
# A tibble: 12 × 4
   SAMPLE_ID                    auto_drop auto_warn qc_class
   <chr>                        <lgl>     <lgl>     <chr>   
 1 2107UNHS-0293_Br2720_Mid_Nuc TRUE      FALSE     drop    
 2 AN00000904_Br2743_Ant_Cyto   TRUE      TRUE      drop    
 3 AN00000904_Br2743_Ant_Nuc    FALSE     TRUE      warn    
 4 AN00000904_Br6522_Mid_Cyto   FALSE     TRUE      warn    
 5 AN00000904_Br8325_Ant_Cyto   FALSE     TRUE      warn    
 6 AN00000904_Br8325_Ant_Nuc    FALSE     TRUE      warn    
 7 AN00000904_Br8492_Mid_Cyto   FALSE     TRUE      warn    
 8 AN00000904_Br8492_Mid_Nuc    FALSE     TRUE      warn    
 9 AN00000904_Br8492_Post_Cyto  FALSE     TRUE      warn    
10 AN00000906_Br2743_Ant_Cyto   FALSE     TRUE      warn    
11 AN00000906_Br8325_Mid_Nuc    FALSE     TRUE      warn    
12 AN00000906_Br8492_Mid_Nuc    FALSE     TRUE      warn    
Joining with `by = join_by(SAMPLE_ID)`
Saving 12 x 7 in image
Saving 12 x 7 in image
Saving 12 x 7 in image
Warning messages:
1: In geom_jitter(aes(shapre = qc_class), width = 0.2) :
  Ignoring unknown aesthetics: shapre
2: In geom_jitter(aes(shapre = qc_class), width = 0.2) :
  Ignoring unknown aesthetics: shapre
Saving 12 x 7 in image
Saving 12 x 7 in image
[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_boxplots_RiboZeroGold.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/qc_boxplots_polyA.png"

Joining with `by = join_by(SAMPLE_ID)`
Saving 7 x 7 in image
Saving 7 x 7 in image
Joining with `by = join_by(SAMPLE_ID, library_prep, qc_class)`
[[1]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/ERCC_scatter_RiboZeroGold.png"

[[2]]
[1] "/dcs04/lieber/lcolladotor/deconvolution_LIBD4030/Human_DLPFC_Deconvolution/plots/02_quality_control/01_check_bulk_qc_metrics/ERCC_scatter_polyA.png"

[1] "Reproducibility information:"
[1] "2023-04-13 16:08:23 EDT"
   user  system elapsed 
146.761   3.660 164.083 
─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.2.3 Patched (2023-04-07 r84211)
 os       CentOS Linux 7 (Core)
 system   x86_64, linux-gnu
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       US/Eastern
 date     2023-04-13
 pandoc   2.19.2 @ /jhpce/shared/jhpce/core/conda/miniconda3-4.11.0/envs/svnR-4.2.x/bin/pandoc

─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────
 package              * version   date (UTC) lib source
 beachmat               2.14.2    2023-04-07 [2] Bioconductor
 Biobase              * 2.58.0    2022-11-01 [2] Bioconductor
 BiocGenerics         * 0.44.0    2022-11-01 [2] Bioconductor
 BiocParallel           1.32.6    2023-03-17 [2] Bioconductor
 bitops                 1.0-7     2021-04-24 [2] CRAN (R 4.2.1)
 cellranger             1.1.0     2016-07-27 [2] CRAN (R 4.2.1)
 cli                    3.6.1     2023-03-23 [2] CRAN (R 4.2.3)
 codetools              0.2-19    2023-02-01 [3] CRAN (R 4.2.3)
 colorspace             2.1-0     2023-01-23 [2] CRAN (R 4.2.2)
 DelayedArray           0.24.0    2022-11-01 [2] Bioconductor
 DelayedMatrixStats     1.20.0    2022-11-01 [2] Bioconductor
 dplyr                * 1.1.1     2023-03-22 [2] CRAN (R 4.2.3)
 fansi                  1.0.4     2023-01-22 [2] CRAN (R 4.2.2)
 farver                 2.1.1     2022-07-06 [2] CRAN (R 4.2.1)
 forcats              * 1.0.0     2023-01-29 [2] CRAN (R 4.2.2)
 fs                     1.6.1     2023-02-06 [2] CRAN (R 4.2.2)
 gargle                 1.3.0     2023-01-30 [2] CRAN (R 4.2.2)
 generics               0.1.3     2022-07-05 [2] CRAN (R 4.2.1)
 GenomeInfoDb         * 1.34.9    2023-02-02 [2] Bioconductor
 GenomeInfoDbData       1.2.9     2022-09-29 [2] Bioconductor
 GenomicRanges        * 1.50.2    2022-12-16 [2] Bioconductor
 GGally               * 2.1.2     2021-06-21 [2] CRAN (R 4.2.1)
 ggplot2              * 3.4.2     2023-04-03 [2] CRAN (R 4.2.3)
 ggrepel              * 0.9.3     2023-02-03 [2] CRAN (R 4.2.2)
 glue                   1.6.2     2022-02-24 [2] CRAN (R 4.2.1)
 googledrive            2.1.0     2023-03-22 [2] CRAN (R 4.2.3)
 gtable                 0.3.3     2023-03-21 [2] CRAN (R 4.2.3)
 here                 * 1.0.1     2020-12-13 [2] CRAN (R 4.2.1)
 hms                    1.1.3     2023-03-21 [2] CRAN (R 4.2.3)
 IRanges              * 2.32.0    2022-11-01 [2] Bioconductor
 jaffelab             * 0.99.32   2022-12-07 [1] Github (LieberInstitute/jaffelab@7b7afe3)
 labeling               0.4.2     2020-10-20 [2] CRAN (R 4.2.1)
 lattice                0.20-45   2021-09-22 [3] CRAN (R 4.2.3)
 lifecycle              1.0.3     2022-10-07 [2] CRAN (R 4.2.1)
 limma                  3.54.2    2023-02-28 [2] Bioconductor
 lubridate            * 1.9.2     2023-02-10 [2] CRAN (R 4.2.2)
 magrittr               2.0.3     2022-03-30 [2] CRAN (R 4.2.1)
 MASS                   7.3-58.2  2023-01-23 [3] CRAN (R 4.2.3)
 Matrix                 1.5-4     2023-04-04 [2] CRAN (R 4.2.3)
 MatrixGenerics       * 1.10.0    2022-11-01 [2] Bioconductor
 matrixStats          * 0.63.0    2022-11-18 [2] CRAN (R 4.2.2)
 munsell                0.5.0     2018-06-12 [2] CRAN (R 4.2.1)
 nlme                   3.1-162   2023-01-31 [2] CRAN (R 4.2.2)
 patchwork            * 1.1.2     2022-08-19 [2] CRAN (R 4.2.1)
 pillar                 1.9.0     2023-03-22 [2] CRAN (R 4.2.3)
 pkgconfig              2.0.3     2019-09-22 [2] CRAN (R 4.2.1)
 plyr                   1.8.8     2022-11-11 [2] CRAN (R 4.2.2)
 purrr                * 1.0.1     2023-01-10 [2] CRAN (R 4.2.2)
 R6                     2.5.1     2021-08-19 [2] CRAN (R 4.2.1)
 rafalib              * 1.0.0     2015-08-09 [1] CRAN (R 4.2.2)
 ragg                   1.2.5     2023-01-12 [2] CRAN (R 4.2.2)
 RColorBrewer           1.1-3     2022-04-03 [2] CRAN (R 4.2.1)
 Rcpp                   1.0.10    2023-01-22 [2] CRAN (R 4.2.2)
 RCurl                  1.98-1.12 2023-03-27 [2] CRAN (R 4.2.3)
 readr                * 2.1.4     2023-02-10 [2] CRAN (R 4.2.2)
 readxl               * 1.4.2     2023-02-09 [2] CRAN (R 4.2.2)
 reshape                0.8.9     2022-04-12 [2] CRAN (R 4.2.1)
 rlang                  1.1.0     2023-03-14 [2] CRAN (R 4.2.3)
 rprojroot              2.0.3     2022-04-02 [2] CRAN (R 4.2.1)
 S4Vectors            * 0.36.2    2023-02-26 [2] Bioconductor
 scales                 1.2.1     2022-08-20 [2] CRAN (R 4.2.1)
 scuttle              * 1.8.4     2023-01-19 [1] Bioconductor
 segmented              1.6-3     2023-03-26 [1] CRAN (R 4.2.3)
 sessioninfo          * 1.2.2     2021-12-06 [2] CRAN (R 4.2.1)
 SingleCellExperiment * 1.20.1    2023-03-17 [2] Bioconductor
 sparseMatrixStats      1.10.0    2022-11-01 [2] Bioconductor
 stringi                1.7.12    2023-01-11 [2] CRAN (R 4.2.2)
 stringr              * 1.5.0     2022-12-02 [2] CRAN (R 4.2.2)
 SummarizedExperiment * 1.28.0    2022-11-01 [2] Bioconductor
 systemfonts            1.0.4     2022-02-11 [2] CRAN (R 4.2.1)
 textshaping            0.3.6     2021-10-13 [2] CRAN (R 4.2.1)
 tibble               * 3.2.1     2023-03-20 [2] CRAN (R 4.2.3)
 tidyr                * 1.3.0     2023-01-24 [2] CRAN (R 4.2.2)
 tidyselect             1.2.0     2022-10-10 [2] CRAN (R 4.2.1)
 tidyverse            * 2.0.0     2023-02-22 [2] CRAN (R 4.2.2)
 timechange             0.2.0     2023-01-11 [2] CRAN (R 4.2.2)
 tzdb                   0.3.0     2022-03-28 [2] CRAN (R 4.2.1)
 utf8                   1.2.3     2023-01-31 [2] CRAN (R 4.2.2)
 vctrs                  0.6.1     2023-03-22 [2] CRAN (R 4.2.3)
 withr                  2.5.0     2022-03-03 [2] CRAN (R 4.2.1)
 XVector                0.38.0    2022-11-01 [2] Bioconductor
 zlibbioc               1.44.0    2022-11-01 [2] Bioconductor

 [1] /users/lhuuki/R/4.2.x
 [2] /jhpce/shared/jhpce/core/conda/miniconda3-4.11.0/envs/svnR-4.2.x/R/4.2.x/lib64/R/site-library
 [3] /jhpce/shared/jhpce/core/conda/miniconda3-4.11.0/envs/svnR-4.2.x/R/4.2.x/lib64/R/library

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
**** Job ends ****
Thu Apr 13 16:08:25 EDT 2023
